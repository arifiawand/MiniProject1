<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
	<h1>WELCOME TO KODEHIVE ACADEMY</h1>
	<div>
		<div>
			<button id="add-data" type="button">
				<a>Add Data</a>
			</button>
		</div>
		<br />
		<table border="1">
			<button id="btn-toggle">hide</button>
			<thead>
				<tr>
					<td>KODE</td>
					<td>MAHASISWA</td>
					<td>GENDER</td>
					<td>JURUSAN</td>
					<td>ALAMAT</td>
					<td>STATUS</td>
					<td>USIA</td>
					<td>SEMESTER</td>
					<td>ACTION</td>
				</tr>
			</thead>
			<tbody id="list-mahasiswa">
				<!--  ambil data dari list.html -->
				<!--  data yang diinput muncul disini -->
			</tbody>
		</table>
		<div class="modal" tabindex="-1" id="modal-edit-mahasiswa">
			<div class="modal-dialog modal-xl">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Edit Data Mahasiswa</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body">
						
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js"></script>
<script type="text/javascript">

	autoRefresh();

	function autoRefresh() {
		$.ajax({
			url : '/kodehive/mahasiswa/list',
			type : 'get',
			dataType : 'html',
			success : function(result) {
				$('#list-mahasiswa').html(result);
			}
		});
	}
	
	
	$("#add-data").on("click", function () {
		$.ajax({
			url: "/kodehive/mahasiswa/add",
			type: "get",
			dataType: "html",
			success: function (result) {
				$("#modal-edit-mahasiswa").modal("show");
				$("#modal-edit-mahasiswa").find(".modal-body").html(result);
			}
		});
	});
	
	$("#modal-edit-mahasiswa").on("submit", "#form-add-mahasiswa", function () {
		$.ajax({
			url: "/kodehive/mahasiswa/create",
			type: "post",
			data: $(this).serialize(),
			success: function (result) {
				alert("data berhasil ditambahkan");
				$("#modal-edit-mahasiswa").modal("hide");
				autoRefresh();
			}
		});
		return false;
	});
	
	$("#list-mahasiswa").on("click", "#btn-edit", function () {
		var kode = $(this).val();
		$.ajax({
			url: "/kodehive/mahasiswa/edit",
			type: "get",
			dataType: "html",
			data: {kode},
			success: function (result) {
				$("#modal-edit-mahasiswa").modal("show");
				$("#modal-edit-mahasiswa").find(".modal-body").html(result);
			}
		});
	});
	
	$("#modal-edit-mahasiswa").on("submit", "#form-edit-mahasiswa", function () {
		$.ajax({
			url: "/kodehive/mahasiswa/update",
			type: "post",
			data: $(this).serialize(),
			success: function (result) {
				alert("data berhasil diupdate");
				$("#modal-edit-mahasiswa").modal("hide");
				autoRefresh();
			}
		});
		return false;
	});
	
	$("#list-mahasiswa").on("click", "#btn-remove", function () {
		var kode = $(this).val();
		$.ajax({
			url: "/kodehive/mahasiswa/remove",
			type: "get",
			dataType: "html",
			data: {kode},
			success: function (result) {
				$("#modal-edit-mahasiswa").modal("show");
				$("#modal-edit-mahasiswa").find(".modal-body").html(result);
			}
		});
	});
	
	
	$("#modal-edit-mahasiswa").on("submit", "#form-mahasiswa-delete", function () {
		$.ajax({
			url: "/kodehive/mahasiswa/delete",
			type: "post",
			data: $(this).serialize(),
			success: function (result) {
				alert("data berhasil dihapus");
				$("#modal-edit-mahasiswa").modal("hide");
				autoRefresh();
			}
		});
		return false;
	});
	
	$("#list-mahasiswa").on("click", "#btn-detail", function () {
		var kode = $(this).val();
		$.ajax({
			url: "/kodehive/mahasiswa/detail",
			type: "get",
			dataType: "html",
			data: {kode},
			success: function (result) {
				$("#modal-edit-mahasiswa").modal("show");
				$("#modal-edit-mahasiswa").find(".modal-body").html(result);
			}
		});
	});
	
	$(document).ready(function(){
		  $("#btn-toggle").click(function(){
		    $("table").toggle();
		  });
		});
</script>
</html>